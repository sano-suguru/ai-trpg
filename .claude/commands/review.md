# コードレビュー

実装されたコードをレビューし、問題点を指摘する。

## 入力

$ARGUMENTS - レビュー対象（ファイルパス、コミット範囲、またはPR番号）

---

## レビュー観点

### 1. アーキテクチャ適合性

**Vertical Slice Architecture:**

- [ ] Feature単位でコードが凝集しているか
- [ ] 依存の方向は正しいか（shared ← api/web）
- [ ] レイヤー間の責務分離は適切か

**FDM（Functional Domain Modeling）:**

- [ ] Branded Typesで型安全なIDを使用しているか
- [ ] Smart Constructorが `Result<T, E>` を返しているか
- [ ] イミュータブル（`readonly`）になっているか

### 2. エラーハンドリング

- [ ] `Result<T, E>` / `ResultAsync<T, E>` を使用しているか
- [ ] `try-catch` を制御フローに使っていないか
- [ ] `throw` 文を使っていないか
- [ ] `Errors.*` ファクトリでエラー生成しているか
- [ ] エラーケースを網羅しているか

### 3. コーディング規約

**命名:**

- [ ] ディレクトリは `kebab-case`
- [ ] TSファイルは `camelCase.ts`
- [ ] Reactコンポーネントは `PascalCase.tsx`
- [ ] 定数は `UPPER_SNAKE_CASE`

**禁止事項:**

- [ ] `any` 型を使用していないか → `unknown` + 型ガード
- [ ] `console.log` が残っていないか
- [ ] import文に拡張子を書いていないか
- [ ] 深い相対パス（`../../../`）を使っていないか
- [ ] 循環依存がないか

### 4. セキュリティ

- [ ] コマンドインジェクション
- [ ] XSS
- [ ] SQLインジェクション
- [ ] 機密情報のハードコード

### 5. パフォーマンス

- [ ] 不要なre-render
- [ ] N+1クエリ
- [ ] 重複した処理
- [ ] 適切なキャッシュ

### 6. テスト容易性

- [ ] 依存性が注入可能か
- [ ] 純粋関数になっているか
- [ ] モック可能な設計か

---

## 出力形式

```markdown
## レビュー結果

### 概要

- 対象: [ファイル/コミット/PR]
- 判定: [Approve / Request Changes / Comment]

### 問題点

#### [重大] ファイル名:行番号

- 問題: ...
- 理由: ...
- 修正案: ...

#### [軽微] ファイル名:行番号

- 問題: ...
- 修正案: ...

### 良かった点

- ...

### 次のアクション

- [ ] ...
```

---

## 重大度の基準

| 重大度   | 基準                                         | 対応     |
| -------- | -------------------------------------------- | -------- |
| **重大** | セキュリティ、データ損失、アーキテクチャ違反 | 必ず修正 |
| **警告** | バグの可能性、パフォーマンス問題             | 修正推奨 |
| **軽微** | 命名、スタイル、改善提案                     | 任意     |
